index.html:

<!--  -->
<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Character encoding for correct text rendering -->
  <meta charset="UTF-8" />
  <!-- Responsive design for different screen sizes -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Author and SEO information -->
  <meta name="author" content="Marton Dominik" />
  <meta name="description" content="Interactive city map quiz — choose a region and start playing!" />
  <meta name="keywords" content="city quiz, map quiz, geography game, interactive quiz" />

  <!-- Page title -->
  <title>City Map Quiz</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="images/favicon.png" />
  <!-- Link to external CSS stylesheet -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<main id="regionPicker">
  <h1>Choose a Region</h1>
  <p>Start typing to search:</p>

  <!-- 
  <input>: represents a field where the user can enter data. 
  type="text": input is a single-line text box
  placeholder="Search regions…": Text displayed inside the input when it’s empty.
  aria-label="Search regions": Accessibility feature for screen readers. 
  ^(Tells visually impaired users what this input does.)
  -->
  <input 
    type="text" 
    id="search" 
    placeholder="Search regions…" 
    aria-label="Search regions"
  />

  <!-- List that will hold region items 
  list items (<li>) are added dynamically using JavaScript.-->
  <ul id="regionList" aria-label="Region list"></ul>

  <!-- Button group for navigation -->
  <div class="buttonGroup">
    <!-- Button to open information page -->
    <button id="openInfoButton">Info</button>
    <!-- Button to open feedback form -->
    <button id="openFormButton">Feedback</button>
  </div>
</main>

<script src="index.js"></script>
</body>
</html>






quiz.html:

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- <meta name="viewport">: Makes the site responsive -->
  <!-- width=device-width: Match the webpage width to the actual width of the device screen.  -->
  <!-- initial-scale=1.0: Don’t zoom in or out -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <meta name="author" content="Marton Dominik" />
  <!-- description: under the title when u search -->
  <meta name="description" content="Play the interactive city map quiz and test your geography knowledge!" />
  <meta name="keywords" content="map quiz, geography game, city locator" />

  <title>City Map Quiz – Play</title>
  <link rel="icon" type="image/png" href="images/favicon.png" />

  <link rel="stylesheet" href="style.css" />
  <link href="https://unpkg.com/maplibre-gl/dist/maplibre-gl.css" rel="stylesheet" />
</head>

<body>

  <!-- <main>: primary content -->
  <!-- <header>: usually contains titles, navigation, or introductory information-->
  <!-- id="infoBar": unique ID for styling or JS updates -->
<main id="quizContainer">

  <header id="infoBar"> <!-- row above map -->
    <button id="backButton">← Back</button>
    <div id="question" class="infoBadge">Loading…</div> <!-- "Find: ..." -->
    <div id="progress" class="infoBadge">Question: 0/0</div>
    <div id="score" class="infoBadge">Correct: 0/0</div>
    <div id="status"></div> <!-- "wrong" and "found" -->
  </header>

  <!-- where the interactive map appears -->
  <!-- <section>: thematic grouping of content often with a heading --> 
  <section id="mapWrapper"> 
    <div id="map"></div>
  </section>

  <div id="cityListContainer">
    <ul id="cityList"></ul>
  </div>

</main>

<!-- vagy headben <script src="script.js" defer></script> -->
<script src="https://unpkg.com/maplibre-gl/dist/maplibre-gl.js"></script>
<script src="quiz.js"></script>

</body>
</html>







form.html:
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Marton Dominik">
  <meta name="description" content="City Quiz Feedback Form">
  <meta name="keywords" content="feedback, form, city quiz">

  <title>City Quiz Feedback</title>

  <link rel="icon" type="image/png" href="images/favicon.png" />
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="formContainer">
  <h1>City Quiz Feedback Form</h1>

  <form id="feedbackForm" action="https://formspree.io/f/mnnywzok" method="POST" novalidate>
        
    <label for="name">Name</label>
    <input type="text" id="name" name="name" placeholder="Your name">

    <label for="age">Age *</label>
    <input type="number" id="age" name="age" placeholder="Your age" min="5" max="120" required>

    <label for="gender">Gender *</label>
    <select id="gender" name="gender" required>
      <option value="">Select...</option>
      <option value="male">Male</option>
      <option value="female">Female</option>
      <option value="other">Other</option>
    </select>

    <label for="from">Country</label>
    <input type="text" id="from" name="from" placeholder="Country you're from: e.g. Finland or .fi">

    <label for="improve">How could we improve the quiz?</label>
    <textarea id="improve" name="improve" placeholder="Your suggestions"></textarea>

    <label for="favorite">Favorite region</label>
    <input type="text" id="favorite" name="favorite" placeholder="e.g. Italy">

    <label for="rating">Rate the quiz (1-10) *</label>
    <div class="sliderContainer">
      <input type="range" id="rating" name="rating" min="1" max="10" value="5" required>
      <!--<span> element is an inline container in HTML. 
      It doesn’t create a new line (like <div> does) 
      and is mainly used to apply styles or manipulate content with JavaScript.-->
      <span id="ratingValue">5</span>
    </div>

    <div class="buttonRow">
      <button type="submit">Submit</button>
      <button type="button" id="backButton">Back to Quizzes</button>
    </div>

  </form>
</div>

<script src="form.js"></script>
</body>
</html>







info.html:

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Marton Dominik">
  <meta name="description" content="Information about the City Map Quiz">
  <meta name="keywords" content="city quiz, info, instructions, cities">
  <title>City Quiz Info</title>
  <link rel="icon" type="image/png" href="images/favicon.png" />
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="infoContainer">
  <h1>About the City Map Quiz</h1>

  <section>
    <h2>How to Play</h2>
    <p>
      The City Map Quiz challenges you to find cities on an interactive map.
      Select a region and a difficulty from the home page, then try to locate the cities as quickly and accurately as possible.
      You can only make three attempts per city. After that, the correct location will be revealed.
      It will only count as correct if you get it on your first try.
    </p>
  </section>

  <section>
  <h2>Updates & Feedback</h2>

  <h3>Coming Changes:</h3>
  <ul style="text-align: left">
    <li>Timer for the quiz</li>
    <li>Scores saved – you can see your highest score for each city</li>
    <li>Different difficulty levels</li>
  </ul>

  <p>
    Don't forget to give feedback using the <a href="form.html">Feedback Form</a> to help improve the quiz!
  </p>
</section>


  <button onclick="window.location.href='index.html'">Back to Home</button>
</div>

</body>
</html>








style.css:
* {
  font-family: "Segoe Script", cursive !important;
}

body {
  text-align: center;
  margin: 0;
  padding: 40px 20px;
}

h1 { 
  margin-bottom: 20px; 
}

input[type="text"] {
  padding: 10px;
  width: 250px;
  font-size: 16px;
  margin-bottom: 20px;
  box-sizing: border-box; /* includes padding + border */
}

/* ----------------- Region List ----------------- */
ul {
  list-style: none;
  padding: 0;
  margin: 0 auto 20px auto;
  text-align: center;
}

#regionList {
  display: flex;
  flex-wrap: wrap;      /* wrap if window too small */
  gap: 10px;            /* space between items */
  justify-content: center; /* center the whole row */
  padding: 0;
  list-style: none;
}

#regionList li {
  padding: 12px 10px;
  border: 1px solid #333;
  border-radius: 5px;
  background-color: #f0f0f0;
  font-size: 16px;
  cursor: pointer;
  flex: 0 0 calc((100% - 6 * 10px) / 7); /* 7 items per row, subtract gaps */
  box-sizing: border-box;
  transition: background 0.2s;
  text-align: center;
}

#regionList li:hover {
  background-color: #ddd; /* darker gray on hover */
}

/* ----------------- Buttons ----------------- */
.buttonGroup {
  margin-top: 70px;
  display: flex;
  flex-direction: column; /* stack vertically */
  align-items: center;
  gap: 10px;
}

.buttonGroup button,
#openInfoButton,
#openFormButton,
#resetBtn {
  padding: 12px 0;
  font-size: 16px;
  border-radius: 5px;
  border: 1px solid #333;
  background-color: #f0f0f0;
  cursor: pointer;
  width: 250px;
  transition: background 0.2s;
}


.buttonGroup button:hover,
#openInfoButton:hover,
#openFormButton:hover,
#resetBtn:hover {
  background-color: #ddd;
}

/* ----------------- Quiz Info Bar ----------------- */
#infoBar {
  display: flex;          /* turns the element into a flex container */
  align-items: center;    /* vertically centers items along the cross-axis */
  justify-content: flex-start; /* aligns items at the start of the main axis (horizontally) */
  flex-wrap: wrap;        /* allows items to move to the next line if they don't fit */
  gap: 10px;              /* adds 10px spacing between items */
  width: 80%;             /* container takes 80% of the parent element's width */
  margin: 0 auto 10px auto;
}

#backButton {
  padding: 8px 16px;
  font-size: 14px;
  cursor: pointer;
  border-radius: 5px;
  border: 1px solid #333;
  background-color: #f0f0f0;
}
#backButton:hover {
  background-color: #ddd;
}

#question, #progress, #score {
  background: rgba(255,255,255,0.9);
  padding: 8px 12px;
  border-radius: 5px; /* rounds the corners of an element’s border. */
  font-size: 16px;
  display: inline-block;
}

#status {
  font-size: 16px;
  font-weight: bold;
  min-width: 180px;
}

#cityListContainer {
  width: calc(80% + 4px); /* same width as #mapWrapper with border */
  margin: 0 auto;  /* centers it exactly like the map */
}

#cityList {
  width: 100%;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  list-style: none;
  padding: 0;
  margin: 15px 0 0 0;
  justify-content: flex-start; /* ensures left alignment */
}

#cityList li {
  flex: 0 0 calc((100% - 4 * 8px) / 5);
  padding: 10px;
  background-color: #ccc;
  border: 1px solid #333;
  border-radius: 5px;
  font-size: 15px;
  text-align: center;
  box-sizing: border-box; /* include padding & border in width */
}

#cityList li.correct {
  background-color: #4caf50; /* green */
  color: white;
}

#cityList li.wrong {
  background-color: #f44336; /* red */
  color: white;
}

/* ----------------- Map ----------------- */
#mapWrapper {
  width: calc(80% + 4px); /* add 2px border on each side = 4px */
  margin: 0 auto;          /* centers the wrapper */
}

#map {
  height: 600px;
  width: 100%;
  border: 2px solid #333;
  box-sizing: border-box; /* include border in width */
  cursor: default;
}


.mapboxgl-canvas,
.maplibregl-canvas {
  cursor: default !important; /* forces this rule to override any other cursor styles applied elsewhere. */
}

/* ----------------- Form Styles ----------------- */
#formContainer {
  width: 80%;
  margin: 0 auto;
  max-width: 600px;
  text-align: left;
}

#formContainer h1 {
  text-align: center;
  margin-bottom: 20px;
}

#formContainer form label {
  display: block;
  margin-top: 10px;
  font-weight: bold;
}

#formContainer form input[type="text"],
#formContainer form input[type="email"],
#formContainer form input[type="number"],
#formContainer form textarea,
#formContainer form select {
  width: 100%;
  padding: 10px;
  margin-top: 5px;
  font-size: 16px;
  border-radius: 5px;
  border: 1px solid #333;
  box-sizing: border-box;
}

#formContainer form textarea {
  height: 80px;
  resize: vertical; /* textarea taller or shorter, but  make it wider. */
}

#formContainer form fieldset {
  border: 1px solid #333;
  padding: 10px;
  margin-top: 10px;
  border-radius: 5px;
}

#formContainer form legend {
  font-weight: bold;
}

#formContainer form input[type="radio"],
#formContainer form input[type="checkbox"] {
  margin-right: 5px;
}

.sliderContainer {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 20px;
}

#lastPlayed {
  margin-bottom: 20px;
}

.radioLabel {
  display: inline-flex;
  align-items: center;
  margin-right: 20px;
  cursor: pointer;
}

.radioLabel input[type="radio"] {
  margin-right: 5px;
}

#formContainer form button {
  margin-top: 15px;
  padding: 10px 20px;
  font-size: 16px;
  border-radius: 5px;
  border: 1px solid #333;
  cursor: pointer;
  background-color: #f0f0f0;
}

#formContainer form button:hover {
  background-color: #ddd;
}

/* ----------------- Info Page ----------------- */
#infoContainer {
  width: 80%;
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
  text-align: left;
}

#infoContainer h1 {
  text-align: center;
  margin-bottom: 20px;
}

#infoContainer section {
  margin-bottom: 20px;
  background: #f9f9f9;
  padding: 15px;
  border-radius: 8px;
  border: 1px solid #ccc;
}

#infoContainer section h2 {
  margin-top: 0;
}

#infoContainer button {
  display: block;
  margin: 20px auto 0 auto;
  padding: 10px 20px;
  font-size: 16px;
  border-radius: 5px;
  border: 1px solid #333;
  background-color: #f0f0f0;
  cursor: pointer;
}

#infoContainer button:hover {
  background-color: #ddd;
}

/* ----------------- Responsive ----------------- 
max-width: “apply these styles if the viewport width is less than or equal to this value”.
If the parent is <body> and <body> is the full viewport width, then effectively it’s 90% of the viewport.*/
@media (max-width: 1024px) {
  #mapWrapper, #infoBar {
    width: 90%;
  }
}

@media (max-width: 768px) {
  #infoBar {
    flex-direction: column;
    align-items: flex-start;
  }

  #backButton, #question, #progress, #score, #status {
    width: 100%;
    text-align: left;
  }

  #map {
    height: 400px;
  }

  input[type="text"] {
    width: 100%;
  }

  ul {
    max-width: 100%;
  }

  #formContainer { width: 95%; }
  #formContainer form button { width: 100%; margin-top: 10px; }

  .buttonGroup {
    flex-direction: column;
    gap: 10px;
  }

  #regionList li,
  .buttonGroup button,
  #openInfoButton,
  #openFormButton {
    width: 90%;
  }
}

@media (max-width: 480px) {
  #map {
    height: 300px;
  }

  #question, #progress, #score, #status {
    font-size: 14px;
    padding: 6px 10px;
  }

  #backButton {
    font-size: 12px;
    padding: 6px 10px;
  }
}











index.js:
const regions = ["World", "France", "Italy", "Spain"];
// get the list element that will hold the regions
const regionListEl = document.getElementById("regionList");

// Ensure "World" is always first in the list
const world = regions.shift(); // remove first element which becomes the value of world
regions.sort(); // alphabetically sort remaining regions
regions.unshift(world); // add "World" back to the start

// searchText = "" means if no argument is passed, it defaults to an empty string.
// searchText: what the user typed in the search box.
function displayRegions(searchText = "") {
  // clear existing list (removes all <li> items)
  regionListEl.innerHTML = "";

  // Filter regions based on search input
  const filteredRegions = regions.filter(region => 
    region.toLowerCase().includes(searchText.toLowerCase())
  );

  // Create a new list item for each filtered region
  // .forEach: runs the function once for each element in the array.
  filteredRegions.forEach(region => {
    // tells the browser to create a new HTML element of type <li>
    const li = document.createElement("li");
    li.textContent = region;
    // <li> elements receive focus -> navigate with keyboard
    li.tabIndex = 0; 
    // setAttribute is a method that takes two arguments:
    // The name of the attribute ("role")
    // The value of the attribute ("button")
    // in the HTML: <li role="button">World</li>
    // role is an ARIA (Accessible Rich Internet Applications) attribute.
    // It tells screen readers and other assistive technologies how to interpret an element
    li.setAttribute("role", "button");

    // navigate to quiz page for the selected region
    li.addEventListener("click", () => {
      window.location.href = `quiz.html?region=${region.toLowerCase()}`;
    });

    // Keyboard accessibility: allow "Enter" key to select
    li.addEventListener("keypress", e => {
      if (e.key === "Enter") li.click();
    });

    // Add list item to the region list
    regionListEl.appendChild(li);
  });
}

// Initial load: display all regions
displayRegions();

// Listen for user input in the search box and filter the list in real-time
// "input" event fires every time the user types
// e.target: <input id="search" type="text">
// e.target.value: logs whatever is typed in the box
document.getElementById("search").addEventListener("input", e => {
  displayRegions(e.target.value);
});

// Open information page when Info button is clicked
document.getElementById("openInfoButton").addEventListener("click", () => {
  window.location.href = "info.html";
});

// Open form when Form button is clicked
document.getElementById("openFormButton").addEventListener("click", () => {
  window.location.href = "form.html";
});







quiz.js:
let map;                      // rn undefined
let cities = [];              // all cities loaded from JSON
let remainingCities = [];     // Cities that haven't been asked yet
let currentCity = null;       // City currently being asked
let answerMarker = null;      // Marker shown when user guesses wrong 3 times
let attempts = 0;             // How many tries the user has made for current city
let correctCount = 0;         // Number of correct answers
let questionCount = 0;        // Number of questions shown so far
let quizLocked = false;       // Prevent clicks while revealing city
let sessionEnded = false;     // Track if quiz is finished
let totalQuestions = null;      // Total questions for this session

// finding HTML elements from the page and storing them in JavaScript variables
const quizContainer = document.getElementById('quizContainer');
const statusEl = document.getElementById('status');
const backButton = document.getElementById('backButton');


// tells it to make the current page index.html when "Back" button is clicked
// .addEventListener() is a method that listens for events on that element.
// 'click' means we are listening for a click event
// () => { ... }: arrow function, inside the { ... } will run when the button is clicked.
// (): no parameter needed
backButton.addEventListener('click', () => {
  window.location.href = "index.html";
});


// GET REGION FROM URL
// Read the "region" parameter from the URL, default to "world"
// window.location = the object representing the current page URL.
// .search = the string part of the URL, which comes after the ?
// quiz.html?region=france -> ?region=france
// urlParams.get("region")  // returns "france"
// urlParams: object key: region value: france ("python dictionary")
// URLSearchParams: in-built class (needs to be called with new)
const urlParams = new URLSearchParams(window.location.search);
const region = urlParams.get("region");


// START QUIZ
function startQuiz(region) {
  // set JSON file for the chosen region
  const citiesFile = `city_jsons/${region}.json`;


  // Map initial center and zoom for each region
  // "python dictionary key:world,france... value: center[longitude, latitude], zoom"
  const regionSettings = {
    world: { center: [0, 20], zoom: 2 },
    france: { center: [2.2137, 46.2276], zoom: 5 },
    spain: { center: [-3.7038, 40.4168], zoom: 5 },
    italy: { center: [12.4964, 41.9028], zoom: 5 }
  };
  const settings = regionSettings[region]


  // Create the interactive map
  // maplibregl.Map is a class provided by the MapLibre library.
  // container: 'map' looks for <div id="map"></div>
  // center: settings.center sets the starting position of the map. (from earlier code)
  // larger numbers = closer zoom
  map = new maplibregl.Map({
    container: 'map',
    style: 'https://api.maptiler.com/maps/019a8239-05ae-74c9-835e-bb2308959812/style.json?key=Log0g5gRFj2BYhuEUZho',
    center: settings.center,
    zoom: settings.zoom,
    doubleClickZoom: false
  });

  // Load cities from JSON
  // fetch: finds the file, then downloads and returns the contents
  // .then(): “When the previous thing is done, run this.”
  // response.json(): reads the JSON text and turns it into a real JavaScript array (data)
  // temporarly returns data (as a the array) which we in the first line make cities be equal to
  /* [...]: takes all elements from the cities array and creates a new array 
  with the same items. (remainingCities = cities: Any change to remainingCities 
  would also change the cities variable.*/ 
  // if region is "world": totalQuestions = 30 else totalQuestions = 10
  fetch(citiesFile)
  .then(response => response.json())
  .then(data => {
    cities = data;                     
    remainingCities = [...cities];     
    totalQuestions = region === "world" ? 30 : 10;
    correctCount = 0;
    questionCount = 0;
    sessionEnded = false;

    const cityListEl = document.getElementById('cityList');
    cityListEl.innerHTML = ''; // clear first

    // Sort cities alphabetically by name
    const sortedCities = cities.slice().sort((a, b) => a.name.localeCompare(b.name));

    // Create <li> for each city in sorted order
    sortedCities.forEach(city => {
      const li = document.createElement('li');
      li.textContent = city.name;
      li.id = `city-${city.name.replace(/\s+/g, '')}`; // unique ID
      cityListEl.appendChild(li);
    });
    
      nextQuestion();   // Start the first question
    });

  // .on() is a method that listens for events (for clicks in this case) on the map
  /* handleMapClick (inbuilt function) receives an event object "e" that contains info 
  about the click including coordinates: console.log(e.lngLat): 
  the longitude and latitude where the user clicked*/
  map.on('click', handleMapClick);
}


// SHOW NEXT QUESTION
function nextQuestion() {
  // Remove the red answer marker if it exists
  if (answerMarker) {
    answerMarker.remove();
    answerMarker = null;
  }

  attempts = 0;           // Reset attempts for new city
  quizLocked = false;     // Allow map clicks again

  // Check if quiz is finished
  if (remainingCities.length == 0) {
    if (!sessionEnded) {
      sessionEnded = true;
      showResetButton();
    }
    document.getElementById('question').textContent = "Quiz Finished!";
    return; // to finish the function so it doesnt try to ask next question
  }

  // Pick a random city from remaining cities
  /* .splice() is an array method that: removes items from an array 
  and returns an array of the removed items like {name: "Paris", lat: 48.8566, lng: 2.3522 } */
  const randomIndex = Math.floor(Math.random() * remainingCities.length);
  currentCity = remainingCities.splice(randomIndex, 1)[0];
  questionCount++;

  // Update score and show the city name
  updateScore();
  document.getElementById('question').textContent = `Find: ${currentCity.name}`;
}

// UPDATE SCORE AND PROGRESS
function updateScore() {
  document.getElementById('score').textContent = `Correct: ${correctCount}/${totalQuestions}`;
  document.getElementById('progress').textContent = `Question: ${questionCount}/${totalQuestions}`;
}

// SHOW RESET BUTTON
function showResetButton() {
  const resetBtn = document.createElement('button');
  resetBtn.id = "resetBtn";
  resetBtn.textContent = "Try Again";
  resetBtn.style.marginTop = '5px';

  // When clicked, restart the quiz
  resetBtn.addEventListener('click', () => {
    remainingCities = [...cities];
    statusEl.textContent = '';
    questionCount = 0;
    correctCount = 0;
    sessionEnded = false;

    cities.forEach(city => {
      const cityLi = document.getElementById(`city-${city.name.replace(/\s+/g, '')}`);
      if (cityLi) cityLi.style.backgroundColor = '#f0f0f0'; // same as your list default
    });

    resetBtn.remove();
    nextQuestion();
  });

  // adds the button to the page inside the quizContainer div, so the user can see it and click it.
  mapWrapper.appendChild(resetBtn);
}


// HANDLE MAP CLICKS
function handleMapClick(e) {
  if (quizLocked || sessionEnded) return; // Ignore clicks if locked

  const clickedLngLat = [e.lngLat.lng, e.lngLat.lat];
  const cityLngLat = [currentCity.lng, currentCity.lat];

  const distance = getDistance(clickedLngLat, cityLngLat);
  const hitboxRadius = 40000; // 40 km

  // Find the corresponding <li> for this city
  const cityLi = document.getElementById(`city-${currentCity.name.replace(/\s+/g, '')}`);

  if (distance < hitboxRadius) {
    // Correct guess
    if (attempts === 0) {
      correctCount++; // Only first try counts as "perfect"
      if (cityLi) cityLi.style.backgroundColor = 'lightgreen'; // Mark as green
    } else {
      if (cityLi) cityLi.style.backgroundColor = 'lightcoral'; // Wrong attempts, mark red
    }

    statusEl.style.color = 'green';
    statusEl.textContent = `You found ${currentCity.name}.`;

    nextQuestion();
  } else {
    // Wrong guess
    attempts++;
    statusEl.style.color = 'red';

    if (attempts >= 3) {
      revealCityPin(cityLngLat); // Reveal correct location after 3 wrong attempts
      if (cityLi) cityLi.style.backgroundColor = 'lightcoral'; // Mark red
    } else {
      statusEl.textContent = `❌ Wrong! Try again. (${attempts}/3)`;
    }
  }

  updateScore();
}

// CALCULATE DISTANCE BETWEEN TWO POINTS
function getDistance([lng1, lat1], [lng2, lat2]) {
  const earthRadius = 6371000; // in meters

  // Convert degrees to radians
  function toRadians(degrees) {
    return degrees * Math.PI / 180;
  }

  const lat1Rad = toRadians(lat1);
  const lat2Rad = toRadians(lat2);
  const deltaLatRad = toRadians(lat2 - lat1);
  const deltaLngRad = toRadians(lng2 - lng1);

  // Haversine formula
  const a = Math.sin(deltaLatRad / 2) * Math.sin(deltaLatRad / 2) +
            Math.cos(lat1Rad) * Math.cos(lat2Rad) *
            Math.sin(deltaLngRad / 2) * Math.sin(deltaLngRad / 2);

  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

  const distance = earthRadius * c; // distance in meters
  return distance;
}


// REVEAL CITY PIN AFTER 3 WRONG ATTEMPTS
function revealCityPin(cityLngLat) {
  if (answerMarker) return;

  quizLocked = true;

  // Add red marker to show correct city
  answerMarker = new maplibregl.Marker({ color: 'red' })
  answerMarker.setLngLat(cityLngLat)
  answerMarker.addTo(map);

  statusEl.textContent = `❌ Wrong! The city pin is revealed, click it to continue.`;

  // Clicking the marker removes it and goes to next question
  // { once: true } means the function will run only once, then automatically remove itself
  answerMarker.getElement().addEventListener('click', function onPinClick(ev) {
    ev.stopPropagation(); // stops the clicks from reaching the parent element (map) listener
    answerMarker.remove();
    answerMarker = null;
    attempts = 0;
    quizLocked = false;
    statusEl.textContent = '';
    nextQuestion();
  }, { once: true });
}


// START QUIZ ON PAGE LOAD
startQuiz(region);









form.js:
const form = document.getElementById('feedbackForm');
const rating = document.getElementById('rating');
const ratingValue = document.getElementById('ratingValue');
const backButton = document.getElementById('backButton');

// Track if slider has been interacted with
let ratingTouched = false;

// INITIALIZE SLIDER
ratingValue.textContent = rating.value;

// Detect user interaction
rating.addEventListener('input', () => {
  ratingValue.textContent = rating.value;
  ratingTouched = true; // mark slider as touched
});

// Also count clicks in case user clicks default value without dragging
rating.addEventListener('click', () => {
  ratingTouched = true;
});

// BACK TO QUIZZES BUTTON
backButton.addEventListener('click', () => {
  window.location.href = 'index.html';
});

// FORM SUBMISSION
form.addEventListener('submit', function(e) {
  let valid = true;
  const messages = [];

  // Age validation
  const age = document.getElementById('age');
  if (!age.value || age.value < 5 || age.value > 120) {
    valid = false;
    messages.push("Valid age (5-120) is required.");
  }

  // Gender validation
  const gender = document.getElementById('gender');
  if (!gender.value) {
    valid = false;
    messages.push("Please select your gender.");
  }

  // Rating validation
  if (!ratingTouched) {
    valid = false;
    messages.push("Please move or click the slider to rate the quiz.");
  }

  // If invalid, stop submission and show errors
  if (!valid) {
    e.preventDefault();
    alert(messages.join("\n"));
  }

});



world.json
[
  {"name": "Paris", "lat": 48.8566, "lng": 2.3522},
  {"name": "Marseille", "lat": 43.2965, "lng": 5.3698},
  {"name": "Lyon", "lat": 45.764, "lng": 4.8357},
  {"name": "Toulouse", "lat": 43.6047, "lng": 1.4442},
  {"name": "Nice", "lat": 43.7102, "lng": 7.262},
  {"name": "Nantes", "lat": 47.2184, "lng": -1.5536},
  {"name": "Strasbourg", "lat": 48.5734, "lng": 7.7521},
  {"name": "Montpellier", "lat": 43.6108, "lng": 3.8767},
  {"name": "Bordeaux", "lat": 44.8378, "lng": -0.5792},
  {"name": "Lille", "lat": 50.6292, "lng": 3.0573},

  {"name": "Madrid", "lat": 40.4168, "lng": -3.7038},
  {"name": "Barcelona", "lat": 41.3851, "lng": 2.1734},
  {"name": "Valencia", "lat": 39.4699, "lng": -0.3763},
  {"name": "Seville", "lat": 37.3891, "lng": -5.9845},
  {"name": "Zaragoza", "lat": 41.6488, "lng": -0.8891},
  {"name": "Málaga", "lat": 36.7213, "lng": -4.4214},
  {"name": "Murcia", "lat": 37.9922, "lng": -1.1307},
  {"name": "Palma", "lat": 39.5696, "lng": 2.6502},
  {"name": "Las Palmas", "lat": 28.1235, "lng": -15.4363},
  {"name": "Bilbao", "lat": 43.263, "lng": -2.935},

  {"name": "Rome", "lat": 41.9028, "lng": 12.4964},
  {"name": "Milan", "lat": 45.4642, "lng": 9.19},
  {"name": "Naples", "lat": 40.8518, "lng": 14.2681},
  {"name": "Turin", "lat": 45.0703, "lng": 7.6869},
  {"name": "Palermo", "lat": 38.1157, "lng": 13.3615},
  {"name": "Genoa", "lat": 44.4056, "lng": 8.9463},
  {"name": "Bologna", "lat": 44.4949, "lng": 11.3426},
  {"name": "Florence", "lat": 43.7696, "lng": 11.2558},
  {"name": "Catania", "lat": 37.5079, "lng": 15.083},
  {"name": "Venice", "lat": 45.4408, "lng": 12.3155}
]
